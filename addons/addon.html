<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML lang=en><HEAD>
<!--Revised: 16 Dec, 1999 By: Enrique Bengoechea-->
<META http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<META name=author content="Enrique Bengoechea">
<TITLE>htmlpp: JScripts for HomeSite 4.0</TITLE>
<STYLE type="text/css">
<!--
BODY {margin: 0em}
A.footer {color: #CCFFFF}
A.index {text-decoration: none}
-->
</STYLE>
</HEAD>
<BODY onLoad="focus()" bgcolor="#000080" marginwidth=0 marginheight=0
margintop=0 marginbottom=0 marginleft=0 marginright=0>

<CENTER>
<TABLE width="100%" border=0 cellspacing=0 celpadding=5 bgcolor="#000080"><TR>
<TD align="left" valign="top">
<A href="../index.html"><IMG src="../images/htmlpp1.gif" width=100 height=75 alt="Htmlpp" border=0>
</A></TD>
<TD align="center">
<FONT color="#FFFF99" face="arial"><H1>JScripts for HomeSite 4.0</H1></FONT>
</TR><TR>
<TD valign=TOP nowrap>
&nbsp;<BR>
<A href="../index.html" class="index" title="Htmlpp Homepage"><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Home</FONT></A>&nbsp;<BR>
<A href="../introduction/index.html" class="index" title="What is Htmlpp and how to start using it"><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Introduction</FONT></A>&nbsp;<BR>
<A href="../download/index.html" class="index" title="How to get Htmlpp and how to install it"><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Download</FONT></A>&nbsp;<BR>
<A href="../docs/index.html" class="index" title="Htmlpp documentation: Reference, FAQ, Known bugs..."><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Docs</FONT></A>&nbsp;<BR>
<A href="../support/index.html" class="index" title="What to do if you have problems with Htmlpp"><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Support</FONT></A>&nbsp;<BR>
<A href="../examples/index.html" class="index" title="Examples of Htmlpp source code"><IMG src="../images/click.gif" width=36 height=36 alt="" border=0 align=middle>
&nbsp;<FONT COLOR="#FFFF99" face="arial">Examples</FONT></A>&nbsp;<BR>
<A href="index.html" class="index" title="Utilities to improve your productivity with Htmlpp"><IMG src="../images/sunken.gif" width=36 height=45 alt="" border=0 align=middle>
&nbsp;<FONT color="#CCFFFF" face="arial"><STRONG>Add-ons</STRONG></FONT></A>&nbsp;<BR>
<TD valign=top bgcolor="white">
<DIV style="padding-left:15pt;padding-right:10pt;padding-top:10pt;padding-bottom:5pt;">
<P align="right"><FONT color="#000080"><EM>Contributed by <A href="http://www.eco.uc3m.es/~ebb/">Enrique Bengoechea</A></EM></FONT>
<UL>
<LI><A href="addon.html#TOC1">Overview</A>
<LI><A href="addon.html#TOC2">Download and Installation</A>
<LI><A href="addon.html#TOC3">Behavior of the Scripts</A>
<UL>
<LI><A href="addon.html#htmlpp">htmlpp.js (Run Htmlpp</A>)
<LI><A href="addon.html#htmlpp_opprocfiles">htmlpp_opprocfiles.js (Open Generated HTML Files</A>)
<LI><A href="addon.html#htmlpp_brfile">htmlpp_brfile.js (Browse First Generated HTML File</A>)
<LI><A href="addon.html#htmlpp_opwrk">htmlpp_opwrk.js (Open Working Files</A>)
<LI><A href="addon.html#htmlpp_clall">htmlpp_clall.js (Close All Last-Run Files</A>)
<LI><A href="addon.html#htmlpp_opinclude">htmlpp_opinclude.js (Open Included Files</A>)
</UL>
<LI><A href="addon.html#TOC10">Scripts History</A>
</UL>
<DIV ALIGN="center">
<IMG src="../images/htmlpphs_bar.gif" width=190 height=51 alt="HomeSite Toolbar for Htmlpp View" border=0 usemap=#toolbar>
</DIV><MAP name="toolbar">
<AREA SHAPE="RECT" COORDS="16,22,38,45" HREF="#htmlpp" TITLE="Run Htmlpp">
<AREA SHAPE="RECT" COORDS="45,22,68,45" HREF="#htmlpp_opprocfiles" TITLE="Open Generated Files">
<AREA SHAPE="RECT" COORDS="69,22,91,45" HREF="#htmlpp_brfile" TITLE="Browse Generated File">
<AREA SHAPE="RECT" COORDS="92,22,114,45" HREF="#htmlpp_opwrk" TITLE="Open Working Files">
<AREA SHAPE="RECT" COORDS="115,22,135,45" HREF="#htmlpp_clall" TITLE="Close Last-Run Files">
<AREA SHAPE="RECT" COORDS="145,22,164,45" HREF="#htmlpp_opinclude" TITLE="Open Included Files">
</MAP>

<FONT color="#000080" face="arial"><H2 style="margin-left:-13pt"><A NAME="TOC1">Overview</A></H2></FONT>

<P><A href="http://htmlpp.org/">Htmlpp</A> is a free HTML preprocessor which allows to industrialise
your HTML writting and simplifies site building and maintenance.
Because Htmlpp is a command-line tool, writting and debugging Htmlpp documents can
be a slow task. <A href="http://www.allaire.com/products/homesite/homesite.cfm">HomeSite</A> is one of the best text-based HTML editor running
under Windows I have found, and provides a customizable rich environment for
writting HTML files.</P>

<P>Here you can find several scripts for HomeSite 4.0 that help you use Htmlpp 4.2b from
within HomeSite, so providing a comfortable graphic environment for running Htmlpp:</P>
<OL>
<LI>The main script opens a dialog that allows you to select Htmlpp options for preprocessing
current document. You can also choose to automatically edit or browse the intermediate
working files and the final HTML files generated by Htmlpp.
<EM><A href="../images/htmlpp_hs.gif">View a Screen Shot of the Dialog</A>.</EM>
<LI>Three scripts allow you to open the generated HTML files, browse the first generated HTML
file, or open the intermediate working files from last run of Htmlpp, respectively.
<LI>A script closes all open files related to the last run of Htmlpp.
<LI>A script opens all .include'd files in current document.
</OL>

<FONT color="#000080" face="arial"><H2 style="margin-left:-13pt"><A NAME="TOC2">Download and Installation</A></H2></FONT>

<P><STRONG>Prerequisites:</STRONG></P>
<UL>
  <LI>The scripts are written in JScript, and require to have installed the
  <A href="http://msdn.microsoft.com/scripting/default.htm?/scripting/jscript/default.htm">Microsoft Scripting Engines 3.01</A>.<BR>
  Note: You should have them installed if you have Internet Explorer 5 or higher. Otherwise,
  you can freely download them from the above link.
  <LI>You need to have installed and working <A href="http://htmlpp.org/">Htmlpp</A> 4.2b or
  superior.
  Previous versions are likely to work also, but 4.2b new options
  (-charset, -connect, -noconnect, and -expires) won't be recognized.
</UL>

<P><STRONG>Installation:</STRONG></P>
<UL>
  <LI>Download <A href="../htmlpp_hs02.zip">htmlpp_hs02.zip</A>
  (25 Kbs.)
  <LI>Unzip the <TT>htmlpp_hs02.zip</TT> file in a temporal directory.
  <LI>In order to generate the graphic dialogs, the free
  <A href="http://www.meadroid.com/scriptx/">ScriptX</A> ActiveX control is required. It is provided with the
  scripts. If you haven't installed it previously, just run the supplied
  <TT>ScriptX.exe</TT> file.
  <LI>From your HomeSite home directory, create the directory &quot;scripts\htmlpp&quot; and
   Copy the files <TT>*.js, *.html</TT> and <TT>*.bmp</TT>,
   to it.
  <LI>Copy the file <TT>htmlpp_hs.pl</TT> to the directory where Htmlpp is installed. You may
   need to customize the path to Htmlpp on it.
  <LI>The scripts assume Htmlpp is installed on 'C:\htmlpp'. If it is not, modify the variable
  'HtmlppPath' in each of the <TT>.js</TT> files.
  <LI>From within HomeSite you can create a ToolBar and add buttons for each script, or
   run the <TT>htmlpp_installer.js</TT> script (e.g. by assigning it a button in a toolbar)
   which will create the toolbar with all the buttons.
</UL>

<FONT color="#000080" face="arial"><H2 style="margin-left:-13pt"><A NAME="TOC3">Behavior of the Scripts</A></H2></FONT>

<P>Whenever you run Htmlpp from within Homesite using the main script, it will store
the names of the source file, the generated HTML files, the working files, and the
errors file in file '<TT>last_process.txt</TT>', which is stored in the same directory
than the scripts. The generated HTML files are obtained by parsing Htmlpp run-time
output.</P>

<P>Storing the info about last run is useful because all other scripts can use it by default
to perform any operation, like 'Open intermediate working files'.</P>

<P>Some of the scripts will work only if the active document has extensions <TT>.htp</TT> or
<TT>.def</TT>. You can modify the scripts to accept different extensions as Htmlpp documents.</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp">htmlpp.js (Run Htmlpp)</A></H3></FONT>
<P>The script starts by closing all open files related to previous Htmlpp
processing (<TT>htmlpp.out</TT>, which contains the captured screen output, <TT>errors.lst</TT>,
and working files <TT>html0001.wrk, html002.wrk</TT>...). This is useful so as not to confuse
files from different Htmlpp runs. Then Htmlpp will be invoked with the selected options, and its
output captured into file <TT>htmlpp.out</TT>. If some error arises, it will prompt to open
the errors file <TT>errors.lst</TT>. Working files <TT>html001.wrk, html002.wrk</TT>, etc. will be
open if you selected it. Also, if you selected to edit or browse the generated HTML files, the script
will parse <TT>htmlpp.out</TT> and open all generated files it founds. Information about all
files is stored in file <TT>last_process.txt</TT> in the scripts directory.</P>

<P><STRONG>NOTE:</STRONG> The language option in the dialog just presets the standard variable
LANG from the command line. If several languages are selected, the file will be processed once
for each language presetting LANG accordingly each time. You can customize the script to adapt
it to the languages you use.</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp_opprocfiles">htmlpp_opprocfiles.js (Open Generated HTML Files)</A></H3></FONT>
<P>If there is only one open documente named <TT>htmlpp.out</TT>, invoking this script will parse
it and open for editing all generated HTML files. Additionally, if there is selected text in that
file, only that text will be parsed, what allows to selectively open files.</P>

<P>If there is no open <TT>htmlpp.out</TT> file, the script will search file <TT>last_process.txt</TT>and use the information from last run.</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp_brfile">htmlpp_brfile.js (Browse First Generated HTML File)</A></H3></FONT>
<P>This script behaves exactly as the previous one but opens only the first HTML file found
in the internal browser (because only one document can be shown at a time).</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp_opwrk">htmlpp_opwrk.js (Open Working Files)</A></H3></FONT>
<P>This script opens all intermediate working files (<TT>html0001.wrk, html0002.wrk</TT>, etc)
from last run of Htmlpp, provided Htmlpp was executed in debug mode.</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp_clall">htmlpp_clall.js (Close All Last-Run Files)</A></H3></FONT>
<P>This script closes all files generated by last run of Htmlpp.</P>

<FONT color="#000080" face="arial"><H3><A name="htmlpp_opinclude">htmlpp_opinclude.js (Open Included Files)</A></H3></FONT>
<P>This script parses current Htmlpp document and opens all included files.
If some text is selected when invoking the script, only that text is parsed, allowing for
selectively open included files.</P>

<FONT color="#000080" face="arial"><H2 style="margin-left:-13pt"><A NAME="TOC10">Scripts History</A></H2></FONT>

<UL>
  <LI><STRONG>Version 0.2</STRONG> released 13 March 1999.
  <UL>
    <LI>Info about last Htmlpp run is stored, so that all scripts refer to that
      info by default.
    <LI>The scripts now correctly handle relative paths of type './doc.htm'.
    <LI>New scripts added: Browse first generated file, Open working files,
      Close all files related last run of Htmlpp, and Open included files.
    <LI>Corrected bug: -set and -page options were not working.
  </UL>
  <LI><STRONG>Version 0.1</STRONG> written 11 March 1999.
</UL>


<MAP NAME="hswebring">
<AREA SHAPE=POLY COORDS="3,4,20,4,26,13,23,13,31,25,27,25,39,45,33,45,11,23,15,23,4,12,9,12,3,4,3,4" HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;list" ALT="Index">
<AREA SHAPE=RECT COORDS="111,16,133,45" HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;id=16;prev" ALT="previous">
<AREA SHAPE=RECT COORDS="134,16,161,45" HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;id=16;random" ALT="random">
<AREA SHAPE=RECT COORDS="161,16,180,45" HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;id=16;next" ALT="next">
<AREA SHAPE=RECT COORDS="0,0,180,50" HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;home" ALT="home">
<AREA SHAPE=default HREF="HTTP://www.webring.com/cgi-bin/webring?ring=homesite;home" ALT="home">
</MAP>
<BR><IMG src="../images/hs_webring.gif" width=180 height=50 alt="HS WebRing links"  border=0 vspace=4 usemap="#hswebring">
<br>
<SMALL><FONT face="arial,helvetica"><A href="http://hsguide.com/webring/">The unofficial HomeSite WebRing</A> made possible by the <a href="http://www.webring.org/">Webring</A>.</FONT></SMALL>
</DIV>
</TD></TR>
<TR><TD align="center" valign="bottom">
<A href="http://www.imatix.com/"><IMG src="../images/im0096c.gif" width=96 height=36 alt="iMatix"  border=0>
</A>
</TD><TD>
<TABLE width="100%" border=0><TR><TD align="left">&nbsp;<BR>
<FONT size=-1 color="#FFFF99">Copyright &copy; 1996-99
iMatix Corporation.<BR> Hosted by <A href="http://www.openavenue.com/" class="footer">OpenAvenue.com</A>.
Made with Htmlpp. Powered by <A href="http://www.xitami.com/" class="footer">Xitami</A>.</FONT></TD>
<TD valign="top" align="right">&nbsp;<BR>
<FONT size=-1 color="#FFFF99">Updated: October 20, 1999<BR>
<A href="mailto:ebb@imatix.com?subject=Feedback on Htmlpp.org site" class="footer">Feedback</A></FONT>
</TD></TR></TABLE>
</TD></TR></TABLE>
</BODY></HTML>
